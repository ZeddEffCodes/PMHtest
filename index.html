<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Norwegian Music Streaming Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #3c4043 0%, #ff4757 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .dashboard {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .header {
            background: linear-gradient(135deg, #3c4043 0%, #ff4757 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header-logos {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 25px;
        }

        .logo {
            height: 50px;
            width: auto;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.2));
        }

        .logo.tono {
            background: #E50012;
            border-radius: 12px;
            padding: 12px 16px;
            height: 50px;
            display: flex;
            align-items: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .controls {
            padding: 20px 30px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .control-group label {
            font-weight: 600;
            color: #495057;
            font-size: 0.9rem;
        }

        select, input {
            padding: 8px 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        select:focus, input:focus {
            outline: none;
            border-color: #3c4043;
            box-shadow: 0 0 0 3px rgba(60, 64, 67, 0.1);
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            padding: 20px 30px;
            background: #f8f9fa;
        }

        .metric-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            border-left: 5px solid;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }

        .metric-card.streams { border-left-color: #3c4043; }
        .metric-card.artists { border-left-color: #f5f6fa; }
        .metric-card.global { border-left-color: #ff4757; }
        .metric-card.norway { border-left-color: #3c4043; }

        .metric-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .metric-label {
            color: #6c757d;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .charts-container {
            padding: 20px 30px 30px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .chart-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .chart-header {
            padding: 20px;
            background: linear-gradient(135deg, #3c4043 0%, #ff4757 100%);
            color: white;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .chart-content {
            padding: 20px;
            height: 300px;
            position: relative;
        }

        .table-container {
            grid-column: 1 / -1;
            margin-top: 20px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .data-table th {
            background: linear-gradient(135deg, #3c4043 0%, #ff4757 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .data-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e9ecef;
        }

        .data-table tbody tr:hover {
            background: #f8f9fa;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3c4043, #ff4757);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        @media (max-width: 768px) {
            .charts-container {
                grid-template-columns: 1fr;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .control-group {
                width: 100%;
            }
        }

        .rank-change {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            font-size: 0.7rem;
            font-weight: 600;
            color: white;
            margin: 0 auto;
        }

        .rank-change.up {
            background: #27ae60;
        }

        .rank-change.down {
            background: #e74c3c;
        }

        .rank-change.new {
            background: #f39c12;
        }

        .rank-change.same {
            background: #95a5a6;
        }

        .chart-placeholder {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #6c757d;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="header">
            <div class="header-logos">
                <!-- Tono Logo -->
                <div class="logo tono">
                    <svg width="80" height="32" viewBox="0 0 80 32" xmlns="http://www.w3.org/2000/svg">
                        <text x="40" y="22" font-family="Poppins, sans-serif" font-size="16" font-weight="700" fill="white" text-anchor="middle">TONO</text>
                        <circle cx="40" cy="8" r="2" fill="white"/>
                    </svg>
                </div>
            </div>
            <h1>Tono Spotify Streaming Analytics</h1>
            <p>Comprehensive analysis of Norwegian artists' global streaming performance</p>
        </div>

        <div class="controls">
            <div class="control-group">
                <label for="artistFilter">Filter by Artist:</label>
                <select id="artistFilter">
                    <option value="">All Artists</option>
                </select>
            </div>
            <div class="control-group">
                <label for="minStreams">Min Norway Streams:</label>
                <input type="number" id="minStreams" placeholder="e.g., 1000000">
            </div>
            <div class="control-group">
                <label for="minShare">Min Norway Share %:</label>
                <input type="number" id="minShare" placeholder="e.g., 10" step="0.1">
            </div>
            <div class="control-group">
                <label for="sortBy">Sort by:</label>
                <select id="sortBy">
                    <option value="Norway_Streams_Kworb">Norway Streams</option>
                    <option value="Global_Streams_Spotify">Global Streams</option>
                    <option value="Norway_Share_Pct">Norway Share %</option>
                    <option value="Norway_Days_on_Chart">Days on Chart</option>
                </select>
            </div>
        </div>

        <div class="metrics-grid">
            <div class="metric-card streams">
                <div class="metric-value" id="totalNorwayStreams">0</div>
                <div class="metric-label">Implied Tono Norway Streams</div>
            </div>
            <div class="metric-card global">
                <div class="metric-value" id="totalGlobalStreams">0</div>
                <div class="metric-label">Implied Tono Global Streams</div>
            </div>
            <div class="metric-card norway">
                <div class="metric-value" id="norwayGlobalShare">0%</div>
                <div class="metric-label">Norway Share of Global</div>
            </div>
        </div>

        <div class="charts-container">
            <div class="table-container">
                <div class="chart-card">
                    <div class="chart-header">Detailed Track Analysis</div>
                    <div class="chart-content" style="height: auto; max-height: 600px; overflow-y: auto;">
                        <table class="data-table" id="dataTable">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>Change</th>
                                    <th>Artist</th>
                                    <th>Track</th>
                                    <th>Norway Streams</th>
                                    <th>Global Streams</th>
                                    <th>Norway Share %</th>
                                    <th>HT Share of Global</th>
                                </tr>
                            </thead>
                            <tbody id="tableBody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="chart-card">
                <div class="chart-header">Top 25 by Global Streams</div>
                <div class="chart-content">
                    <div id="topGlobalChart" class="chart-placeholder">
                        Loading chart data...
                    </div>
                </div>
            </div>

            <div class="chart-card">
                <div class="chart-header">Top 25 by Norway Streams</div>
                <div class="chart-content">
                    <div id="topNorwayChart" class="chart-placeholder">
                        Loading chart data...
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Enhanced sample data with simulated ranking changes
        const musicData = [
            {artist: "Alan Walker", track: "Faded", norwayStreams: 47658559, globalStreams: 2184831184, norwayShare: 2.18, daysOnChart: 1466, rankChange: "same", previousRank: 1},
            {artist: "Ballinciaga", track: "Dans På Bordet", norwayStreams: 47398671, globalStreams: 56053174, norwayShare: 84.56, daysOnChart: 943, rankChange: "up", previousRank: 3},
            {artist: "Freddy Kalas", track: "Jovial", norwayStreams: 33624549, globalStreams: 81653392, norwayShare: 41.18, daysOnChart: 1285, rankChange: "down", previousRank: 2},
            {artist: "Emma Steinbakken", track: "Floden", norwayStreams: 32498481, globalStreams: 38717915, norwayShare: 83.94, daysOnChart: 784, rankChange: "same", previousRank: 4},
            {artist: "Karpe", track: "PAF.no", norwayStreams: 30932204, globalStreams: 38434560, norwayShare: 80.48, daysOnChart: 767, rankChange: "up", previousRank: 6},
            {artist: "Chris Holsten", track: "Smilet i ditt eget speil", norwayStreams: 28938505, globalStreams: 36494781, norwayShare: 79.29, daysOnChart: 981, rankChange: "down", previousRank: 5},
            {artist: "Kygo", track: "It Ain't Me (with Selena Gomez)", norwayStreams: 25844037, globalStreams: 1584231024, norwayShare: 1.63, daysOnChart: 515, rankChange: "same", previousRank: 7},
            {artist: "Ballinciaga", track: "Beklager (Guttaklubben)", norwayStreams: 25307386, globalStreams: 34378561, norwayShare: 73.61, daysOnChart: 646, rankChange: "new", previousRank: null},
            {artist: "Freddy Kalas", track: "Pinne for landet", norwayStreams: 24716228, globalStreams: 87436172, norwayShare: 28.27, daysOnChart: 1254, rankChange: "down", previousRank: 8},
            {artist: "Kygo", track: "Firestone", norwayStreams: 23614923, globalStreams: 1231737610, norwayShare: 1.92, daysOnChart: 727, rankChange: "same", previousRank: 10},
            {artist: "Freddy Kalas", track: "Hey Ho", norwayStreams: 23604363, globalStreams: 90670924, norwayShare: 26.03, daysOnChart: 531, rankChange: "up", previousRank: 12},
            {artist: "Emma Steinbakken", track: "Jeg glemmer deg aldri", norwayStreams: 22804354, globalStreams: 31614513, norwayShare: 72.13, daysOnChart: 921, rankChange: "down", previousRank: 11},
            {artist: "Kygo", track: "Stole the Show", norwayStreams: 21875287, globalStreams: 1115397694, norwayShare: 1.96, daysOnChart: 728, rankChange: "same", previousRank: 13},
            {artist: "Julie Bergan", track: "Arigato", norwayStreams: 19177994, globalStreams: 91966723, norwayShare: 20.85, daysOnChart: 433, rankChange: "up", previousRank: 15},
            {artist: "Kygo", track: "Higher Love", norwayStreams: 19036411, globalStreams: 1093872843, norwayShare: 1.74, daysOnChart: 729, rankChange: "down", previousRank: 14},
            {artist: "Alan Walker", track: "Alone", norwayStreams: 18554228, globalStreams: 838306307, norwayShare: 2.21, daysOnChart: 498, rankChange: "same", previousRank: 16},
            {artist: "Freddy Kalas", track: "Feel Da Rush", norwayStreams: 18254355, globalStreams: 59518652, norwayShare: 30.67, daysOnChart: 570, rankChange: "new", previousRank: null},
            {artist: "Chris Holsten", track: "Hvis verden", norwayStreams: 17637233, globalStreams: 26344101, norwayShare: 66.95, daysOnChart: 650, rankChange: "up", previousRank: 19},
            {artist: "Emma Steinbakken", track: "Delilah", norwayStreams: 17521634, globalStreams: 22921614, norwayShare: 76.44, daysOnChart: 423, rankChange: "down", previousRank: 17},
            {artist: "Astrid S", track: "I Don't Know Why", norwayStreams: 17317786, globalStreams: 159397652, norwayShare: 10.86, daysOnChart: 447, rankChange: "down", previousRank: 18},
            {artist: "Astrid S", track: "Hurts So Good - Slow + Reverb", norwayStreams: 17300100, globalStreams: 35335555, norwayShare: 48.96, daysOnChart: 269, rankChange: "same", previousRank: 21},
            {artist: "Alan Walker", track: "Darkside", norwayStreams: 17017337, globalStreams: 667312419, norwayShare: 2.55, daysOnChart: 478, rankChange: "up", previousRank: 23},
            {artist: "Astrid S", track: "Hurts So Good", norwayStreams: 16460932, globalStreams: 631910079, norwayShare: 2.60, daysOnChart: 533, rankChange: "down", previousRank: 20},
            {artist: "Seeb", track: "Drink About", norwayStreams: 16151482, globalStreams: 130715489, norwayShare: 12.36, daysOnChart: 458, rankChange: "down", previousRank: 22},
            {artist: "Karpe", track: "Lett å være rebell i kjellerleiligheten din", norwayStreams: 16049863, globalStreams: 34620015, norwayShare: 46.36, daysOnChart: 799, rankChange: "new", previousRank: null}
        ];

        let filteredData = [...musicData];

        function formatNumber(num) {
            if (num >= 1000000000) {
                return (num / 1000000000).toFixed(1) + 'B';
            } else if (num >= 1000000) {
                return (num / 1000000).toFixed(1) + 'M';
            } else if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num.toString();
        }

        function updateMetrics() {
            const totalNorway = filteredData.reduce((sum, item) => sum + item.norwayStreams, 0);
            const totalGlobal = filteredData.reduce((sum, item) => sum + item.globalStreams, 0);
            const norwayGlobalShare = totalGlobal > 0 ? (totalNorway / totalGlobal) * 100 : 0;

            document.getElementById('totalNorwayStreams').textContent = formatNumber(totalNorway);
            document.getElementById('totalGlobalStreams').textContent = formatNumber(totalGlobal);
            document.getElementById('norwayGlobalShare').textContent = norwayGlobalShare.toFixed(2) + '%';
        }

        function getRankChangeIcon(rankChange, currentRank, previousRank) {
            if (rankChange === 'new') {
                return '<div class="rank-change new">N</div>';
            } else if (rankChange === 'same') {
                return '<div class="rank-change same">-</div>';
            } else if (rankChange === 'up') {
                const change = previousRank - currentRank;
                return `<div class="rank-change up">+${change}</div>`;
            } else if (rankChange === 'down') {
                const change = currentRank - previousRank;
                return `<div class="rank-change down">-${change}</div>`;
            }
            return '<div class="rank-change same">-</div>';
        }

        function updateTable() {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            filteredData.slice(0, 50).forEach((item, index) => {
                const currentRank = index + 1;
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="rank-column">${currentRank}</td>
                    <td style="text-align: center;">${getRankChangeIcon(item.rankChange, currentRank, item.previousRank)}</td>
                    <td><strong>${item.artist}</strong></td>
                    <td>${item.track}</td>
                    <td>${formatNumber(item.norwayStreams)}</td>
                    <td>${formatNumber(item.globalStreams)}</td>
                    <td>${item.norwayShare.toFixed(2)}%</td>
                    <td>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${Math.min(item.norwayShare, 100)}%"></div>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateCharts() {
            // Top 25 by Global Streams
            const topGlobal = [...filteredData]
                .sort((a, b) => b.globalStreams - a.globalStreams)
                .slice(0, 25);

            const topGlobalChart = document.getElementById('topGlobalChart');
            topGlobalChart.innerHTML = topGlobal.map((track, index) => `
                <div style="display: flex; align-items: center; margin-bottom: 10px; font-size: 0.8rem;">
                    <div style="width: 15px; text-align: center; color: #6c757d; font-weight: 600;">${index + 1}</div>
                    <div style="width: 120px; font-weight: 500; margin-left: 10px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${track.artist} - ${track.track}</div>
                    <div style="flex: 1; background: #e9ecef; height: 15px; border-radius: 8px; margin: 0 10px; overflow: hidden;">
                        <div style="width: ${(track.globalStreams / topGlobal[0].globalStreams) * 100}%; height: 100%; background: linear-gradient(90deg, #3c4043, #ff4757); border-radius: 8px;"></div>
                    </div>
                    <div style="width: 60px; text-align: right; color: #6c757d; font-size: 0.75rem;">${formatNumber(track.globalStreams)}</div>
                </div>
            `).join('');

            // Top 25 by Norway Streams
            const topNorway = [...filteredData]
                .sort((a, b) => b.norwayStreams - a.norwayStreams)
                .slice(0, 25);

            const topNorwayChart = document.getElementById('topNorwayChart');
            topNorwayChart.innerHTML = topNorway.map((track, index) => `
                <div style="display: flex; align-items: center; margin-bottom: 10px; font-size: 0.8rem;">
                    <div style="width: 15px; text-align: center; color: #6c757d; font-weight: 600;">${index + 1}</div>
                    <div style="width: 120px; font-weight: 500; margin-left: 10px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${track.artist} - ${track.track}</div>
                    <div style="flex: 1; background: #e9ecef; height: 15px; border-radius: 8px; margin: 0 10px; overflow: hidden;">
                        <div style="width: ${(track.norwayStreams / topNorway[0].norwayStreams) * 100}%; height: 100%; background: linear-gradient(90deg, #3c4043, #ff4757); border-radius: 8px;"></div>
                    </div>
                    <div style="width: 60px; text-align: right; color: #6c757d; font-size: 0.75rem;">${formatNumber(track.norwayStreams)}</div>
                </div>
            `).join('');
        }

        function applyFilters() {
            const artistFilter = document.getElementById('artistFilter').value;
            const minStreams = parseInt(document.getElementById('minStreams').value) || 0;
            const minShare = parseFloat(document.getElementById('minShare').value) || 0;
            const sortBy = document.getElementById('sortBy').value;

            filteredData = musicData.filter(item => {
                return (!artistFilter || item.artist === artistFilter) &&
                       item.norwayStreams >= minStreams &&
                       item.norwayShare >= minShare;
            });

            // Sort data
            filteredData.sort((a, b) => {
                const aVal = a[sortBy] || 0;
                const bVal = b[sortBy] || 0;
                return bVal - aVal;
            });

            updateMetrics();
            updateTable();
            updateCharts();
        }

        function initializeFilters() {
            const artistSelect = document.getElementById('artistFilter');
            const uniqueArtists = [...new Set(musicData.map(item => item.artist))].sort();
            
            uniqueArtists.forEach(artist => {
                const option = document.createElement('option');
                option.value = artist;
                option.textContent = artist;
                artistSelect.appendChild(option);
            });

            // Add event listeners
            document.getElementById('artistFilter').addEventListener('change', applyFilters);
            document.getElementById('minStreams').addEventListener('input', applyFilters);
            document.getElementById('minShare').addEventListener('input', applyFilters);
            document.getElementById('sortBy').addEventListener('change', applyFilters);
        }

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            initializeFilters();
            applyFilters();
        });
    </script>
</body>
</html>
