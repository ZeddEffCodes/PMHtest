<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nordic Music Streaming Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #3c4043 0%, #ff4757 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .dashboard {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .header {
            background: linear-gradient(135deg, #3c4043 0%, #ff4757 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header-logos {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 25px;
        }

        .logo {
            height: 50px;
            width: auto;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.2));
        }

        .logo.tono {
            background: #E50012;
            border-radius: 12px;
            padding: 16px 24px;
            height: 70px;
            display: flex;
            align-items: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .controls {
            padding: 20px 30px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .control-group label {
            font-weight: 600;
            color: #495057;
            font-size: 0.9rem;
        }

        select, input {
            padding: 8px 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        select:focus, input:focus {
            outline: none;
            border-color: #3c4043;
            box-shadow: 0 0 0 3px rgba(60, 64, 67, 0.1);
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 20px 30px;
            background: #f8f9fa;
        }

        .metric-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            border-left: 5px solid;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }

        .metric-card.streams { border-left-color: #3c4043; }
        .metric-card.artists { border-left-color: #f5f6fa; }
        .metric-card.global { border-left-color: #ff4757; }
        .metric-card.norway { border-left-color: #3c4043; }

        .metric-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .metric-label {
            color: #6c757d;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .charts-container {
            padding: 10px 30px 30px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .chart-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .chart-header {
            padding: 20px;
            background: linear-gradient(135deg, #3c4043 0%, #ff4757 100%);
            color: white;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .chart-content {
            padding: 20px;
            height: 300px;
            position: relative;
        }

        .table-container {
            grid-column: 1 / -1;
            margin-top: 20px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .data-table th {
            background: linear-gradient(135deg, #3c4043 0%, #ff4757 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .data-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e9ecef;
        }

        .data-table tbody tr:hover {
            background: #f8f9fa;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3c4043, #ff4757);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        @media (max-width: 768px) {
            .charts-container {
                grid-template-columns: 1fr;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .control-group {
                width: 100%;
            }
        }

        .rank-change {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            font-size: 0.7rem;
            font-weight: 600;
            color: white;
            margin: 0 auto;
        }

        .rank-change.up {
            background: #27ae60;
        }

        .rank-change.down {
            background: #e74c3c;
        }

        .rank-change.new {
            background: #f39c12;
        }

        .rank-change.same {
            background: #95a5a6;
        }

        .chart-placeholder {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #6c757d;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="header">
            <div class="header-logos">
                <!-- Tono Logo -->
                <div class="logo tono">
                    <svg width="100" height="40" viewBox="0 0 100 40" xmlns="http://www.w3.org/2000/svg">
                        <text x="50" y="28" font-family="Poppins, sans-serif" font-size="20" font-weight="700" fill="white" text-anchor="middle">TONO</text>
                        <circle cx="50" cy="10" r="3" fill="white"/>
                    </svg>
                </div>
            </div>
            <h1>Nordic Spotify Streaming Analytics</h1>
            <p>Cross-market analysis of Tono repertoire performance across Norway, Denmark, Sweden & Finland</p>
        </div>

        <div class="controls">
            <div class="control-group">
                <label for="artistFilter">Filter by Artist:</label>
                <select id="artistFilter">
                    <option value="">All Artists</option>
                </select>
            </div>
            <div class="control-group">
                <label for="minStreams">Min Norway Streams:</label>
                <input type="number" id="minStreams" placeholder="e.g., 1000000">
            </div>
            <div class="control-group">
                <label for="minShare">Min Norway Share %:</label>
                <input type="number" id="minShare" placeholder="e.g., 10" step="0.1">
            </div>
            <div class="control-group">
                <label for="sortBy">Rank by:</label>
                <select id="sortBy">
                    <option value="norwayStreams">ðŸ‡³ðŸ‡´ Norway Streams</option>
                    <option value="htStreams">Total HT Streams</option>
                    <option value="globalStreams">Global Streams</option>
                    <option value="norwayShare">Norway Share %</option>
                </select>
            </div>
        </div>

        <div class="metrics-grid">
            <div class="metric-card streams">
                <div class="metric-value" id="totalNorwayStreams">0</div>
                <div class="metric-label">Norway Streams</div>
            </div>
            <div class="metric-card global">
                <div class="metric-value" id="totalGlobalStreams">0</div>
                <div class="metric-label">Total Nordic Streams</div>
            </div>
            <div class="metric-card artists">
                <div class="metric-value" id="totalGlobalAllStreams">0</div>
                <div class="metric-label">Global Streams</div>
            </div>
            <div class="metric-card norway">
                <div class="metric-value" id="norwayGlobalShare">0%</div>
                <div class="metric-label">Nordic Share of Global</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="nordicShareBar" style="width: 0%"></div>
                </div>
            </div>
        </div>

        <div class="charts-container">
            <div class="table-container">
                <div class="chart-card">
                    <div class="chart-header">Top 50 Detailed Track Analysis</div>
                    <div class="chart-content" style="height: auto; max-height: 600px; overflow-y: auto;">
                        <table class="data-table" id="dataTable">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>Change</th>
                                    <th>Artist</th>
                                    <th>Track</th>
                                    <th>ðŸ‡³ðŸ‡´ Norway Streams</th>
                                    <th>ðŸ‡©ðŸ‡° Denmark Streams</th>
                                    <th>ðŸ‡¸ðŸ‡ª Sweden Streams</th>
                                    <th>ðŸ‡«ðŸ‡® Finland Streams</th>
                                    <th>Total HT Streams</th>
                                    <th>Global Streams</th>
                                    <th>Norway Share %</th>
                                </tr>
                            </thead>
                            <tbody id="tableBody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="chart-card">
                <div class="chart-header">Top 25 by Global Streams</div>
                <div class="chart-content">
                    <div id="topGlobalChart" class="chart-placeholder">
                        Loading chart data...
                    </div>
                </div>
            </div>

            <div class="chart-card">
                <div class="chart-header">Nordic Cross-Market Analysis</div>
                <div class="chart-content" style="height: auto; max-height: 400px; overflow-y: auto;">
                    <div id="nordicAnalysisChart">
                        <div style="margin-bottom: 15px; padding: 10px; background: #f8f9fa; border-radius: 8px;">
                            <strong>Tracks with Nordic presence:</strong>
                            <div id="nordicPresenceStats" style="font-size: 0.9rem; color: #6c757d; margin-top: 5px;"></div>
                        </div>
                        <div id="nordicTracksList"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Enhanced sample data with Nordic countries cross-market performance
        const musicData = [
            {artist: "Alan Walker", track: "Faded", norwayStreams: 47658559, globalStreams: 2184831184, norwayShare: 2.18, daysOnChart: 1466, rankChange: "same", previousRank: 1, denmarkStreams: 12456789, swedenStreams: 23789456, finlandStreams: 8234567},
            {artist: "Ballinciaga", track: "Dans PÃ¥ Bordet", norwayStreams: 47398671, globalStreams: 56053174, norwayShare: 84.56, daysOnChart: 943, rankChange: "up", previousRank: 3, denmarkStreams: null, swedenStreams: 1234567, finlandStreams: null},
            {artist: "Freddy Kalas", track: "Jovial", norwayStreams: 33624549, globalStreams: 81653392, norwayShare: 41.18, daysOnChart: 1285, rankChange: "down", previousRank: 2, denmarkStreams: 2345678, swedenStreams: 4567890, finlandStreams: 1234567},
            {artist: "Emma Steinbakken", track: "Floden", norwayStreams: 32498481, globalStreams: 38717915, norwayShare: 83.94, daysOnChart: 784, rankChange: "same", previousRank: 4, denmarkStreams: null, swedenStreams: 2345678, finlandStreams: null},
            {artist: "Karpe", track: "PAF.no", norwayStreams: 30932204, globalStreams: 38434560, norwayShare: 80.48, daysOnChart: 767, rankChange: "up", previousRank: 6, denmarkStreams: null, swedenStreams: 1789456, finlandStreams: null},
            {artist: "Chris Holsten", track: "Smilet i ditt eget speil", norwayStreams: 28938505, globalStreams: 36494781, norwayShare: 79.29, daysOnChart: 981, rankChange: "down", previousRank: 5, denmarkStreams: null, swedenStreams: 1456789, finlandStreams: null},
            {artist: "Kygo", track: "It Ain't Me (with Selena Gomez)", norwayStreams: 25844037, globalStreams: 1584231024, norwayShare: 1.63, daysOnChart: 515, rankChange: "same", previousRank: 7, denmarkStreams: 18234567, swedenStreams: 34567890, finlandStreams: 12345678},
            {artist: "Ballinciaga", track: "Beklager (Guttaklubben)", norwayStreams: 25307386, globalStreams: 34378561, norwayShare: 73.61, daysOnChart: 646, rankChange: "new", previousRank: null, denmarkStreams: null, swedenStreams: 987654, finlandStreams: null},
            {artist: "Freddy Kalas", track: "Pinne for landet", norwayStreams: 24716228, globalStreams: 87436172, norwayShare: 28.27, daysOnChart: 1254, rankChange: "down", previousRank: 8, denmarkStreams: 1234567, swedenStreams: 3456789, finlandStreams: 987654},
            {artist: "Kygo", track: "Firestone", norwayStreams: 23614923, globalStreams: 1231737610, norwayShare: 1.92, daysOnChart: 727, rankChange: "same", previousRank: 10, denmarkStreams: 15678901, swedenStreams: 28901234, finlandStreams: 9876543},
            {artist: "Freddy Kalas", track: "Hey Ho", norwayStreams: 23604363, globalStreams: 90670924, norwayShare: 26.03, daysOnChart: 531, rankChange: "up", previousRank: 12, denmarkStreams: 1567890, swedenStreams: 2890123, finlandStreams: 876543},
            {artist: "Emma Steinbakken", track: "Jeg glemmer deg aldri", norwayStreams: 22804354, globalStreams: 31614513, norwayShare: 72.13, daysOnChart: 921, rankChange: "down", previousRank: 11, denmarkStreams: null, swedenStreams: 1234567, finlandStreams: null},
            {artist: "Kygo", track: "Stole the Show", norwayStreams: 21875287, globalStreams: 1115397694, norwayShare: 1.96, daysOnChart: 728, rankChange: "same", previousRank: 13, denmarkStreams: 14567890, swedenStreams: 26789012, finlandStreams: 8765432},
            {artist: "Marcus & Martinus", track: "Elektrisk", norwayStreams: 20456789, globalStreams: 145678912, norwayShare: 14.04, daysOnChart: 445, rankChange: "new", previousRank: null, denmarkStreams: 4567890, swedenStreams: 8901234, finlandStreams: 2345678},
            {artist: "Julie Bergan", track: "Arigato", norwayStreams: 19177994, globalStreams: 91966723, norwayShare: 20.85, daysOnChart: 433, rankChange: "up", previousRank: 15, denmarkStreams: 2345678, swedenStreams: 4567890, finlandStreams: 1234567},
            {artist: "Kygo", track: "Higher Love", norwayStreams: 19036411, globalStreams: 1093872843, norwayShare: 1.74, daysOnChart: 729, rankChange: "down", previousRank: 14, denmarkStreams: 13456789, swedenStreams: 25678901, finlandStreams: 7654321},
            {artist: "Alan Walker", track: "Alone", norwayStreams: 18554228, globalStreams: 838306307, norwayShare: 2.21, daysOnChart: 498, rankChange: "same", previousRank: 16, denmarkStreams: 8901234, swedenStreams: 16789012, finlandStreams: 5432109},
            {artist: "Freddy Kalas", track: "Feel Da Rush", norwayStreams: 18254355, globalStreams: 59518652, norwayShare: 30.67, daysOnChart: 570, rankChange: "new", previousRank: null, denmarkStreams: 1123456, swedenStreams: 2234567, finlandStreams: 765432},
            {artist: "Chris Holsten", track: "Hvis verden", norwayStreams: 17637233, globalStreams: 26344101, norwayShare: 66.95, daysOnChart: 650, rankChange: "up", previousRank: 19, denmarkStreams: null, swedenStreams: 1345678, finlandStreams: null},
            {artist: "Emma Steinbakken", track: "Delilah", norwayStreams: 17521634, globalStreams: 22921614, norwayShare: 76.44, daysOnChart: 423, rankChange: "down", previousRank: 17, denmarkStreams: null, swedenStreams: 987654, finlandStreams: null},
            {artist: "Astrid S", track: "I Don't Know Why", norwayStreams: 17317786, globalStreams: 159397652, norwayShare: 10.86, daysOnChart: 447, rankChange: "down", previousRank: 18, denmarkStreams: 3456789, swedenStreams: 6789012, finlandStreams: 2345678},
            {artist: "Astrid S", track: "Hurts So Good - Slow + Reverb", norwayStreams: 17300100, globalStreams: 35335555, norwayShare: 48.96, daysOnChart: 269, rankChange: "same", previousRank: 21, denmarkStreams: 1234567, swedenStreams: 2345678, finlandStreams: 876543},
            {artist: "Alan Walker", track: "Darkside", norwayStreams: 17017337, globalStreams: 667312419, norwayShare: 2.55, daysOnChart: 478, rankChange: "up", previousRank: 23, denmarkStreams: 7890123, swedenStreams: 14567890, finlandStreams: 4321098},
            {artist: "Astrid S", track: "Hurts So Good", norwayStreams: 16460932, globalStreams: 631910079, norwayShare: 2.60, daysOnChart: 533, rankChange: "down", previousRank: 20, denmarkStreams: 5678901, swedenStreams: 10123456, finlandStreams: 3210987},
            {artist: "Seeb", track: "Drink About", norwayStreams: 16151482, globalStreams: 130715489, norwayShare: 12.36, daysOnChart: 458, rankChange: "down", previousRank: 22, denmarkStreams: 2345678, swedenStreams: 4567890, finlandStreams: 1234567},
            {artist: "Karpe", track: "Lett Ã¥ vÃ¦re rebell i kjellerleiligheten din", norwayStreams: 16049863, globalStreams: 34620015, norwayShare: 46.36, daysOnChart: 799, rankChange: "new", previousRank: null, denmarkStreams: null, swedenStreams: 1123456, finlandStreams: null},
            {artist: "Sigrid", track: "Don't Kill My Vibe", norwayStreams: 15987654, globalStreams: 456789123, norwayShare: 3.50, daysOnChart: 567, rankChange: "up", previousRank: 29, denmarkStreams: 7890123, swedenStreams: 15678901, finlandStreams: 4567890},
            {artist: "Tix", track: "Fallen Angel", norwayStreams: 15876234, globalStreams: 45123456, norwayShare: 35.19, daysOnChart: 445, rankChange: "up", previousRank: 27, denmarkStreams: 987654, swedenStreams: 2134567, finlandStreams: 654321},
            {artist: "Seeb", track: "Breathe", norwayStreams: 15654321, globalStreams: 156789123, norwayShare: 9.98, daysOnChart: 512, rankChange: "down", previousRank: 25, denmarkStreams: 3456789, swedenStreams: 7890123, finlandStreams: 2345678},
            {artist: "AURORA", track: "Runaway", norwayStreams: 15456789, globalStreams: 678912345, norwayShare: 2.28, daysOnChart: 789, rankChange: "up", previousRank: 32, denmarkStreams: 9876543, swedenStreams: 18901234, finlandStreams: 6789012},
            {artist: "Chris Holsten", track: "Bare gi deg hen", norwayStreams: 15234567, globalStreams: 18987654, norwayShare: 80.24, daysOnChart: 634, rankChange: "same", previousRank: 28, denmarkStreams: null, swedenStreams: 876543, finlandStreams: null},
            {artist: "Keiino", track: "Spirit in the Sky", norwayStreams: 14987654, globalStreams: 78345612, norwayShare: 19.13, daysOnChart: 456, rankChange: "up", previousRank: 31, denmarkStreams: 2345678, swedenStreams: 5678901, finlandStreams: 1789456},
            {artist: "Cezinando", track: "HÃ¥per du har plass", norwayStreams: 14823456, globalStreams: 21456789, norwayShare: 69.09, daysOnChart: 445, rankChange: "new", previousRank: null, denmarkStreams: null, swedenStreams: 1234567, finlandStreams: null},
            {artist: "Matoma", track: "False Alarm", norwayStreams: 14756389, globalStreams: 234567891, norwayShare: 6.29, daysOnChart: 387, rankChange: "down", previousRank: 30, denmarkStreams: 4567890, swedenStreams: 8901234, finlandStreams: 3456789},
            {artist: "Kygo", track: "Happy Now", norwayStreams: 14523456, globalStreams: 934567891, norwayShare: 1.55, daysOnChart: 678, rankChange: "down", previousRank: 29, denmarkStreams: 12345678, swedenStreams: 23456789, finlandStreams: 6789012},
            {artist: "Julie Bergan", track: "STFU", norwayStreams: 14289123, globalStreams: 67891234, norwayShare: 21.05, daysOnChart: 398, rankChange: "up", previousRank: 34, denmarkStreams: 1456789, swedenStreams: 3456789, finlandStreams: 987654},
            {artist: "Emma Steinbakken", track: "Not Gonna Cry", norwayStreams: 14078654, globalStreams: 17234567, norwayShare: 81.71, daysOnChart: 445, rankChange: "same", previousRank: 33, denmarkStreams: null, swedenStreams: 723456, finlandStreams: null},
            {artist: "Madcon", track: "Don't Worry", norwayStreams: 13945678, globalStreams: 567891234, norwayShare: 2.45, daysOnChart: 678, rankChange: "up", previousRank: 40, denmarkStreams: 6789012, swedenStreams: 12345678, finlandStreams: 4567890},
            {artist: "Boy Pablo", track: "Everytime", norwayStreams: 13876234, globalStreams: 189345672, norwayShare: 7.33, daysOnChart: 523, rankChange: "down", previousRank: 30, denmarkStreams: 4567890, swedenStreams: 8901234, finlandStreams: 3456789},
            {artist: "Freddy Kalas", track: "Radio", norwayStreams: 13654321, globalStreams: 56789123, norwayShare: 24.04, daysOnChart: 456, rankChange: "up", previousRank: 37, denmarkStreams: 1234567, swedenStreams: 2345678, finlandStreams: 789123},
            {artist: "Susanne SundfÃ¸r", track: "Music for People in Trouble", norwayStreams: 13567890, globalStreams: 45678912, norwayShare: 29.71, daysOnChart: 334, rankChange: "new", previousRank: null, denmarkStreams: 987654, swedenStreams: 1876543, finlandStreams: 654321},
            {artist: "Astrid S", track: "Marilyn Monroe", norwayStreams: 13445678, globalStreams: 234567891, norwayShare: 5.73, daysOnChart: 567, rankChange: "down", previousRank: 32, denmarkStreams: 6789012, swedenStreams: 12345678, finlandStreams: 4567890},
            {artist: "Karpe", track: "Hvite menn som pusher 50", norwayStreams: 13234567, globalStreams: 16789123, norwayShare: 78.83, daysOnChart: 423, rankChange: "same", previousRank: 36, denmarkStreams: null, swedenStreams: 987654, finlandStreams: null},
            {artist: "Alan Walker", track: "Different World", norwayStreams: 13023456, globalStreams: 445678912, norwayShare: 2.92, daysOnChart: 389, rankChange: "up", previousRank: 40, denmarkStreams: 5678901, swedenStreams: 11234567, finlandStreams: 3456789},
            {artist: "Seeb", track: "Grip", norwayStreams: 12834567, globalStreams: 89123456, norwayShare: 14.40, daysOnChart: 345, rankChange: "down", previousRank: 35, denmarkStreams: 2345678, swedenStreams: 4567890, finlandStreams: 1234567},
            {artist: "Highasakite", track: "Since Last Wednesday", norwayStreams: 12723456, globalStreams: 67891234, norwayShare: 18.74, daysOnChart: 567, rankChange: "new", previousRank: null, denmarkStreams: 1567890, swedenStreams: 3456789, finlandStreams: 987654},
            {artist: "Nico & Vinz", track: "Am I Wrong", norwayStreams: 12654321, globalStreams: 1234567890, norwayShare: 1.03, daysOnChart: 723, rankChange: "same", previousRank: 39, denmarkStreams: 15678901, swedenStreams: 28901234, finlandStreams: 9876543},
            {artist: "Chris Holsten", track: "Mine Ã¸yne", norwayStreams: 12456789, globalStreams: 15678912, norwayShare: 79.45, daysOnChart: 267, rankChange: "new", previousRank: null, denmarkStreams: null, swedenStreams: 654321, finlandStreams: null},
            {artist: "Dagny", track: "Strangers / Lovers", norwayStreams: 12356789, globalStreams: 78912345, norwayShare: 15.66, daysOnChart: 334, rankChange: "up", previousRank: 49, denmarkStreams: 2345678, swedenStreams: 4567890, finlandStreams: 1456789},
            {artist: "Tix", track: "Ut av mÃ¸rket", norwayStreams: 12278945, globalStreams: 23456789, norwayShare: 52.35, daysOnChart: 334, rankChange: "up", previousRank: 43, denmarkStreams: 789123, swedenStreams: 1456789, finlandStreams: 456789},
            {artist: "K-391", track: "Ignite", norwayStreams: 12156789, globalStreams: 345678912, norwayShare: 3.52, daysOnChart: 445, rankChange: "down", previousRank: 45, denmarkStreams: 4567890, swedenStreams: 8901234, finlandStreams: 3456789}
        ];

        let filteredData = [...musicData];

        function formatNumber(num) {
            if (num >= 1000000000) {
                return (num / 1000000000).toFixed(1) + 'B';
            } else if (num >= 1000000) {
                return (num / 1000000).toFixed(1) + 'M';
            } else if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num.toString();
        }

        function updateMetrics() {
            const totalNorway = filteredData.reduce((sum, item) => sum + item.norwayStreams, 0);
            const totalDenmark = filteredData.reduce((sum, item) => sum + (item.denmarkStreams || 0), 0);
            const totalSweden = filteredData.reduce((sum, item) => sum + (item.swedenStreams || 0), 0);
            const totalFinland = filteredData.reduce((sum, item) => sum + (item.finlandStreams || 0), 0);
            const totalGlobalAll = filteredData.reduce((sum, item) => sum + item.globalStreams, 0);
            const totalNordic = totalNorway + totalDenmark + totalSweden + totalFinland;
            const nordicGlobalShare = totalGlobalAll > 0 ? (totalNordic / totalGlobalAll) * 100 : 0;

            document.getElementById('totalNorwayStreams').textContent = formatNumber(totalNorway);
            document.getElementById('totalGlobalStreams').textContent = formatNumber(totalNordic);
            document.getElementById('totalGlobalAllStreams').textContent = formatNumber(totalGlobalAll);
            document.getElementById('norwayGlobalShare').textContent = nordicGlobalShare.toFixed(2) + '%';
            document.getElementById('nordicShareBar').style.width = Math.min(nordicGlobalShare, 100) + '%';
        }

        function getRankChangeIcon(rankChange, currentRank, previousRank) {
            if (rankChange === 'new') {
                return '<div class="rank-change new">N</div>';
            } else if (rankChange === 'same') {
                return '<div class="rank-change same">-</div>';
            } else if (rankChange === 'up') {
                const change = previousRank - currentRank;
                return `<div class="rank-change up">+${change}</div>`;
            } else if (rankChange === 'down') {
                const change = currentRank - previousRank;
                return `<div class="rank-change down">-${change}</div>`;
            }
            return '<div class="rank-change same">-</div>';
        }

        function updateTable() {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            filteredData.slice(0, 50).forEach((item, index) => {
                const currentRank = index + 1;
                const row = document.createElement('tr');
                
                // Helper function to format Nordic country streams
                const formatNordicStreams = (streams) => {
                    return streams ? formatNumber(streams) : '-';
                };

                // Calculate Total HT Streams (sum of all Nordic countries)
                const totalHTStreams = item.norwayStreams + 
                                     (item.denmarkStreams || 0) + 
                                     (item.swedenStreams || 0) + 
                                     (item.finlandStreams || 0);
                
                row.innerHTML = `
                    <td class="rank-column">${currentRank}</td>
                    <td style="text-align: center;">${getRankChangeIcon(item.rankChange, currentRank, item.previousRank)}</td>
                    <td><strong>${item.artist}</strong></td>
                    <td>${item.track}</td>
                    <td>${formatNumber(item.norwayStreams)}</td>
                    <td>${formatNordicStreams(item.denmarkStreams)}</td>
                    <td>${formatNordicStreams(item.swedenStreams)}</td>
                    <td>${formatNordicStreams(item.finlandStreams)}</td>
                    <td><strong>${formatNumber(totalHTStreams)}</strong></td>
                    <td>${formatNumber(item.globalStreams)}</td>
                    <td>
                        ${item.norwayShare.toFixed(2)}%
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${Math.min(item.norwayShare, 100)}%"></div>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateCharts() {
            // Top 25 by Global Streams
            const topGlobal = [...filteredData]
                .sort((a, b) => b.globalStreams - a.globalStreams)
                .slice(0, 25);

            const topGlobalChart = document.getElementById('topGlobalChart');
            topGlobalChart.innerHTML = topGlobal.map((track, index) => `
                <div style="display: flex; align-items: center; margin-bottom: 10px; font-size: 0.8rem;">
                    <div style="width: 15px; text-align: center; color: #6c757d; font-weight: 600;">${index + 1}</div>
                    <div style="width: 120px; font-weight: 500; margin-left: 10px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${track.artist} - ${track.track}</div>
                    <div style="flex: 1; background: #e9ecef; height: 15px; border-radius: 8px; margin: 0 10px; overflow: hidden;">
                        <div style="width: ${(track.globalStreams / topGlobal[0].globalStreams) * 100}%; height: 100%; background: linear-gradient(90deg, #3c4043, #ff4757); border-radius: 8px;"></div>
                    </div>
                    <div style="width: 60px; text-align: right; color: #6c757d; font-size: 0.75rem;">${formatNumber(track.globalStreams)}</div>
                </div>
            `).join('');

            // Nordic Cross-Market Analysis
            const nordicTracks = filteredData.filter(track => 
                track.denmarkStreams || track.swedenStreams || track.finlandStreams
            ).slice(0, 15);

            const nordicPresenceStats = document.getElementById('nordicPresenceStats');
            const tracksInDenmark = filteredData.filter(t => t.denmarkStreams).length;
            const tracksInSweden = filteredData.filter(t => t.swedenStreams).length;
            const tracksInFinland = filteredData.filter(t => t.finlandStreams).length;
            
            nordicPresenceStats.innerHTML = `
                Denmark: ${tracksInDenmark} tracks | Sweden: ${tracksInSweden} tracks | Finland: ${tracksInFinland} tracks
            `;

            const nordicTracksList = document.getElementById('nordicTracksList');
            nordicTracksList.innerHTML = nordicTracks.map((track, index) => {
                const nordics = [
                    track.denmarkStreams ? `ðŸ‡©ðŸ‡° ${formatNumber(track.denmarkStreams)}` : null,
                    track.swedenStreams ? `ðŸ‡¸ðŸ‡ª ${formatNumber(track.swedenStreams)}` : null,
                    track.finlandStreams ? `ðŸ‡«ðŸ‡® ${formatNumber(track.finlandStreams)}` : null
                ].filter(Boolean).join(' | ');

                return `
                <div style="display: flex; align-items: center; margin-bottom: 12px; font-size: 0.8rem; padding: 8px; background: white; border-radius: 6px; border-left: 3px solid #ff4757;">
                    <div style="width: 15px; text-align: center; color: #6c757d; font-weight: 600;">${index + 1}</div>
                    <div style="width: 140px; font-weight: 500; margin-left: 10px;">
                        <div style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${track.artist}</div>
                        <div style="font-size: 0.7rem; color: #6c757d; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${track.track}</div>
                    </div>
                    <div style="flex: 1; margin-left: 10px; font-size: 0.75rem; color: #495057;">
                        ðŸ‡³ðŸ‡´ ${formatNumber(track.norwayStreams)} | ${nordics}
                    </div>
                </div>
                `;
            }).join('');
        }

        function applyFilters() {
            const artistFilter = document.getElementById('artistFilter').value;
            const minStreams = parseInt(document.getElementById('minStreams').value) || 0;
            const minShare = parseFloat(document.getElementById('minShare').value) || 0;
            const sortBy = document.getElementById('sortBy').value;

            filteredData = musicData.filter(item => {
                return (!artistFilter || item.artist === artistFilter) &&
                       item.norwayStreams >= minStreams &&
                       item.norwayShare >= minShare;
            });

            // Sort data based on selected criteria
            filteredData.sort((a, b) => {
                let aVal, bVal;
                
                if (sortBy === 'htStreams') {
                    // Calculate Total HT Streams for sorting
                    aVal = a.norwayStreams + (a.denmarkStreams || 0) + (a.swedenStreams || 0) + (a.finlandStreams || 0);
                    bVal = b.norwayStreams + (b.denmarkStreams || 0) + (b.swedenStreams || 0) + (b.finlandStreams || 0);
                } else if (sortBy === 'norwayStreams') {
                    aVal = a.norwayStreams;
                    bVal = b.norwayStreams;
                } else if (sortBy === 'globalStreams') {
                    aVal = a.globalStreams;
                    bVal = b.globalStreams;
                } else if (sortBy === 'norwayShare') {
                    aVal = a.norwayShare;
                    bVal = b.norwayShare;
                } else {
                    // Default to Norway streams
                    aVal = a.norwayStreams;
                    bVal = b.norwayStreams;
                }
                
                return bVal - aVal; // Sort descending (highest first)
            });

            updateMetrics();
            updateTable();
            updateCharts();
        }

        function initializeFilters() {
            const artistSelect = document.getElementById('artistFilter');
            const uniqueArtists = [...new Set(musicData.map(item => item.artist))].sort();
            
            uniqueArtists.forEach(artist => {
                const option = document.createElement('option');
                option.value = artist;
                option.textContent = artist;
                artistSelect.appendChild(option);
            });

            // Add event listeners
            document.getElementById('artistFilter').addEventListener('change', applyFilters);
            document.getElementById('minStreams').addEventListener('input', applyFilters);
            document.getElementById('minShare').addEventListener('input', applyFilters);
            document.getElementById('sortBy').addEventListener('change', applyFilters);
        }

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            initializeFilters();
            applyFilters();
        });
    </script>
</body>
</html>
